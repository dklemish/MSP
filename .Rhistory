}
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,10))
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,10))
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,2))
x <- seq(0,2,by=0.05)
d <- dstable(x, 0.2, 1, 1, 0)
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,2))
x <- seq(0,2,by=0.1)
d <- dstable(x, 0.2, 1, 1, 0)
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,2))
rstable
pi2
stabledist::pi2
install.packages("FMStable")
library(FMStable)
rstable
junk <- rstable(1e6, 2, 1, 1, 0)
hist(junk)
hist(junk, freq=FALSE)
sd(junk)
lines(seq(-5,5,by=0.01), dnorm(seq(-5,5,by=0.01), 0, sqrt(2)), col="red")
library(MSP)
n <- 100
n.sim <- 1000
# marg.test.BR  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.EG  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET2 <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET3 <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS.A <- matrix(0, nrow=n.sim, ncol=n)
for(i in 1:n.sim){
#marg.test.BR[i,]  <- simMSP(n=n, dim=1, model="Brown-Resnick", seed=i)$Z
#marg.test.EG[i,]  <- simMSP(n=n, dim=1, model="extremeGauss", seed=i)$Z
#marg.test.ET2[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=2)$Z
#marg.test.ET3[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=3)$Z
marg.test.RS[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1)$Z
marg.test.RS.A[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1, keepPsi=TRUE)$A
}
test <- gev(c(marg.test.RS)); test$par.ests; test$par.ses
x <- seq(0,2,by=0.1)
d <- dstable(x, 0.2, 1, 1, 0)
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,2))
zeta <- pi/2
b <- tan(0.2*zeta)
u <- runif(1e6, -pi/2, pi/2)
w <- rexp(1e6, 1.0)
alp <- 0.2
zeta <- -tan(alp*pi/2)
xi <- pi/2
U <- runif(1e6, -pi/2, pi/2)
W <- rexp(1e6, 1.0)
X <- (1+zeta^2)^(1/(2*alp)) * (sin(alp*(U+zeta))/(cos(U)^(1/alp))) * (cos((1-alp)*U - alp*zeta)/W)^(1/alp - 1)
x <- seq(0,5,by=0.1)
d <- dstable(x, 0.5, 1, 1, 0)
ggplot(data=data.frame(x=X), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
X <- (1+zeta^2)^(1/(2*alp)) * (sin(alp*(U+zeta))/(cos(U)^(1/alp))) * (cos((1-alp)*U - alp*zeta)/W)^(1/alp - 1) + zeta
x <- seq(0,5,by=0.1)
d <- dstable(x, 0.5, 1, 1, 0)
ggplot(data=data.frame(x=X), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
X <- (1+zeta^2)^(1/(2*alp)) * (sin(alp*(U+zeta))/(cos(U)^(1/alp))) * (cos((1-alp)*U - alp*zeta)/W)^(1/alp - 1) - zeta
x <- seq(0,5,by=0.1)
d <- dstable(x, 0.5, 1, 1, 0)
ggplot(data=data.frame(x=X), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
X <- (1+zeta^2)^(1/(2*alp)) * (sin(alp*(U+zeta))/(cos(U)^(1/alp))) * (cos((1-alp)*U - alp*zeta)/W)^(1/alp - 1) + zeta
x <- seq(0,5,by=0.1)
d <- dstable(x, alp, 1, 1, 0)
ggplot(data=data.frame(x=X), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
X <-  (sin(alp*(U+zeta))/(cos(U)^(1/alp))) * (cos((1-alp)*U - alp*zeta)/W)^(1/alp - 1)
ggplot(data=data.frame(x=X), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
X <-  (sin(alp*(U-xi))/(cos(U)^(1/alp))) * (cos(U-alp*(U-xi))/W)^(1/alp - 1)
ggplot(data=data.frame(x=X), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
summary(X)
X <-  (sin(alp*(U+xi))/(cos(U)^(1/alp))) * (cos(U-alp*(U+xi))/W)^(1/alp - 1)
ggplot(data=data.frame(x=X), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
rstable
X <- rstable(1e6, alp, 1, 1, 0)
x <- seq(0,5,by=0.1)
d <- dstable(x, alp, 1, 1, 0)
ggplot(data=data.frame(x=X), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
?rstable
ggplot(data=data.frame(x=X), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=30) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
Z <- (sin(alp*(theta0 + theta)) / ((cos(alp*theta0)*cos(theta)) ^ (1/alp))) *
(cos(alp*theta0 + (alp-1)*theta)/W)^((1-alp)/alp)
alp <- 0.2
theta0 <- tan(pi*alp/2)/alp
theta  <- runif(1e5, -pi/2, pi/2)
W      <- rexp(1e5, 1.0)
Z <- (sin(alp*(theta0 + theta)) / ((cos(alp*theta0)*cos(theta)) ^ (1/alp))) *
(cos(alp*theta0 + (alp-1)*theta)/W)^((1-alp)/alp)
ggplot(data=data.frame(x=Z), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=30) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
d <- dstable(x, alp, 1, 1, 0, 1)
ggplot(data=data.frame(x=Z), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=30) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
d <- dstable(x, alp, 1, 1, 0, 2)
ggplot(data=data.frame(x=Z), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=30) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
d <- dstable(x, alp, 1, 1, 0, 3)
ggplot(data=data.frame(x=Z), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=30) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
X <- rstable(1e6, alp, 1, 1, 0)
ggplot() +
geom_density(aes(x=X), col="blue", alpha=0.3) +
geom_density(aes(x=Z), col="red", alpha=0.3) +
lims(x=c(0,5))
ggplot() +
geom_density(aes(x=X), fill="blue", alpha=0.3) +
geom_density(aes(x=Z), fill="red", alpha=0.3) +
lims(x=c(0,5))
library(MSP)
n <- 100
n.sim <- 1000
# marg.test.BR  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.EG  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET2 <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET3 <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS.A <- matrix(0, nrow=n.sim, ncol=n)
for(i in 1:n.sim){
#marg.test.BR[i,]  <- simMSP(n=n, dim=1, model="Brown-Resnick", seed=i)$Z
#marg.test.EG[i,]  <- simMSP(n=n, dim=1, model="extremeGauss", seed=i)$Z
#marg.test.ET2[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=2)$Z
#marg.test.ET3[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=3)$Z
marg.test.RS[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1)$Z
marg.test.RS.A[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1, keepPsi=TRUE)$A
}
test <- gev(c(marg.test.RS)); test$par.ests; test$par.ses
test <- gev(c(marg.test.RS.A)); test$par.ests; test$par.ses
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
x <- seq(0,5,by=0.1)
d <- dstable(x, 0.2, 1, 1, 0)
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
library(stabledist)
beta <- 1
gamma <- 1
delta <- 0
alpha <- 0.4
test <- rstable(1e5, alpha, beta, gamma, delta)
library(ggplot2)
x <- seq(0.01, 100, by=0.01)
y <- dstable(x, alpha, beta, gamma, delta)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..))
summary(test)
?rstable
beta <- 1
gamma <- 1
delta <- 0
alpha <- 0.4
test <- rstable(1e5, alpha, beta, gamma, delta) + tan(pi*alpha/2)
summary(test)
quantile(test, seq(0,1,by=0.1))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..)) +
lims(x=c(0,50))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=50) +
lims(x=c(0,50))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=50) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
test <- rstable(1e6, alpha, beta, gamma, delta) + tan(pi*alpha/2)
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=50) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
alpha <- 0.2
test <- rstable(1e6, alpha, beta, gamma, delta) + tan(pi*alpha/2)
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=50) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta, pm=1)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta, pm=0)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
y <- dstable(x, alpha, beta, gamma, delta, pm=2)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
y <- dstable(x, alpha, beta, gamma, delta, pm=1)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
alpha <- 0.5
test <- rstable(1e6, alpha, beta, gamma, delta) + tan(pi*alpha/2)
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta, pm=1)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
alpha <- 0.9
test <- rstable(1e6, alpha, beta, gamma, delta) + tan(pi*alpha/2)
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta, pm=1)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
summary(test)
test <- rstable(1e6, alpha, beta, gamma, delta)
summary(test)
u <- runif(1e5, -pi/2, pi/2)
w <- rexp(1e5)
zeta <- -1*tan(pi*alpha/2)
zeta <- -1*tan(pi*alpha/2)
xi <- atan(-zeta)/alpha
xi
pi/2
xi <- pi/2
zeta
(1+zeta^2)^(1/(2*alpha))
z <- (1+zeta^2)^(1/(2*alpha))*(sin(alpha*(u+xi))/(cos(u)^(1/alpha)))*(cos(u-alpha*(u+xi)/w))^((1-alpha)/alpha)
summary(z)
u <- runif(1e5, -pi/2, pi/2)
w <- rexp(1e5)
zeta <- -1*tan(pi*alpha/2)
xi <- pi/2
z <- (1+zeta^2)^(1/(2*alpha))*(sin(alpha*(u+xi))/(cos(u)^(1/alpha)))*(cos(u-alpha*(u+xi)/w))^((1-alpha)/alpha)
summary(z)
u <- runif(1e5, -pi/2, pi/2)
w <- rexp(1e5)
zeta <- -1*tan(pi*alpha/2)
xi <- pi/2
z <- (1+zeta^2)^(1/(2*alpha))*(sin(alpha*(u+xi))/(cos(u)^(1/alpha)))*(cos(u-alpha*(u+xi)/w))^((1-alpha)/alpha)
summary(z)
tan(pi*alpha/2)
U <- runif(1e5, 0, pi)
W <- rexp(1e5)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
summary(Z+tan(pi*alpha/2))
alpha <- 0.3
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
alpha <- 0.1
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
alpha <- 0.9
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
U <- runif(1e6, -pi/2, pi/2)
W <- rexp(1e6)
Z <- 2*sqrt(W)*sin(U)
summary(Z)
qnorm(0.95, 0, 1)
qnorm(0.75, 0, 1)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100)
sd(Z)
mean(Z)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=seq(-5,5,by=0.01),y=dnorm(seq(-5,5,by=0.01),0, sqrt(2))), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=seq(-5,5,by=0.01),y=dnorm(seq(-5,5,by=0.01),0, sqrt(2))), aes(x=x,y=y), color="red")
theta <- rexp(1e6, -pi/2, pi/2)
theta <- runif(1e6, -pi/2, pi/2)
theta0 <- pi/2
W <- rexp(1e6, 1)
b <- alpha*(theta-theta0)
head(theta-theta0)
alpha <- 0.5
b <- alpha*(theta-theta0)
Z <- sin(b)/(cos(theta)^(1/alpha))*(cos(theta-b)/W)^(1/alpha - 1)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100)
summary(Z)
alpha <- 0.5
epsilon <- 1-alpha
theta <- runif(1e6, -pi/2, pi/2)
theta0 <- pi/2
W <- rexp(1e6, 1)
z <- (cos(epsilon*theta-tan(alpha*theta0)*cos(alpha*theta)))/(W*cos(theta))
Z <- tan(alpha*theta0) + ((sin(alpha*theta)-tan(alpha*theta0)*cos(alpha*theta))/cos(theta))*z^(epsilon/(1-epsilon))
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100)
summary(Z)
alpha <- 0.5
zet <- -tan(alpha*pi/2)
con1 <- (1+zet^2)^(1/(2*alpha))
U <- runif(1e5, -pi/2, pi/2)
W <- rexp(1e5, 1)
xi <- pi/2
rm(con1)
alpha <- 0.5
zet <- -tan(alpha*pi/2)
xi <- pi/2
U <- runif(1e5, -pi/2, pi/2)
W <- rexp(1e5, 1)
part1 <- (1+zet^2)^(1/(2*alpha))
part2 <- sin(alpha*(U+xi))
part3 <- cos(U)^(1/alpha)
part4 <- (cos(U-alpha*(U+xi)))/W
Z <- part1 * (part2/part3) * (part4)^((1-alpha)/alpha)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10))
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10)) +
geom_line(data=data.frame(x=seq(0,10,by=0.1),y=dstable(seq(0,10,by=0.1), alpha, 1, 1, 0)), aes(x=x,y=y), color="red")
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10)) +
geom_line(data=data.frame(x=seq(0,10,by=0.1),y=dstable(seq(0,10,by=0.1), alpha, 1, 0, 1)), aes(x=x,y=y), color="red")
?dstable
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10)) +
geom_line(data=data.frame(x=seq(0,10,by=0.1),y=dstable(seq(0,10,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
warnings()
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10)) +
geom_line(data=data.frame(x=seq(0.1,10,by=0.1),y=dstable(seq(0.1,10,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
alpha <- 0.5
zet <- -tan(alpha*pi/2)
xi <- pi/2
U <- runif(1e5, -pi/2, pi/2)
W <- rexp(1e5, 1)
part1 <- (1+zet^2)^(1/(2*alpha))
part2 <- sin(alpha*(U+xi))
part3 <- cos(U)^(1/alpha)
part4 <- (cos(U-alpha*(U+xi)))/W
Z <- part1 * (part2/part3) * (part4)^((1-alpha)/alpha)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=200) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=300) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
?ks.test
ks.test(Z, "pstable", alpha, 1, pm=1)
alpha <- 0.3
zet <- -tan(alpha*pi/2)
xi <- pi/2
U <- runif(1e6, -pi/2, pi/2)
W <- rexp(1e6, 1)
part1 <- (1+zet^2)^(1/(2*alpha))
part2 <- sin(alpha*(U+xi))
part3 <- cos(U)^(1/alpha)
part4 <- (cos(U-alpha*(U+xi)))/W
Z <- part1 * (part2/part3) * (part4)^((1-alpha)/alpha)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=300) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
alpha <- 0.7
zet <- -tan(alpha*pi/2)
xi <- pi/2
U <- runif(1e6, -pi/2, pi/2)
W <- rexp(1e6, 1)
part1 <- (1+zet^2)^(1/(2*alpha))
part2 <- sin(alpha*(U+xi))
part3 <- cos(U)^(1/alpha)
part4 <- (cos(U-alpha*(U+xi)))/W
Z <- part1 * (part2/part3) * (part4)^((1-alpha)/alpha)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=300) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
ks.test(Z, "pstable", alpha, 1, pm=1)
warnings()
n <- 100
n.sim <- 1000
# marg.test.BR  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.EG  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET2 <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET3 <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS.A <- matrix(0, nrow=n.sim, ncol=n)
for(i in 1:n.sim){
#marg.test.BR[i,]  <- simMSP(n=n, dim=1, model="Brown-Resnick", seed=i)$Z
#marg.test.EG[i,]  <- simMSP(n=n, dim=1, model="extremeGauss", seed=i)$Z
#marg.test.ET2[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=2)$Z
#marg.test.ET3[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=3)$Z
marg.test.RS[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1)$Z
marg.test.RS.A[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1, keepPsi=TRUE)$A
}
library(MSP)
n <- 100
n.sim <- 1000
# marg.test.BR  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.EG  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET2 <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET3 <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS.A <- matrix(0, nrow=n.sim, ncol=n)
for(i in 1:n.sim){
#marg.test.BR[i,]  <- simMSP(n=n, dim=1, model="Brown-Resnick", seed=i)$Z
#marg.test.EG[i,]  <- simMSP(n=n, dim=1, model="extremeGauss", seed=i)$Z
#marg.test.ET2[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=2)$Z
#marg.test.ET3[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=3)$Z
marg.test.RS[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1)$Z
marg.test.RS.A[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1, keepPsi=TRUE)$A
}
