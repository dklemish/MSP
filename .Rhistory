# marg.test.EG  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET2 <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET3 <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS.A <- matrix(0, nrow=n.sim, ncol=n)
for(i in 1:n.sim){
#marg.test.BR[i,]  <- simMSP(n=n, dim=1, model="Brown-Resnick", seed=i)$Z
#marg.test.EG[i,]  <- simMSP(n=n, dim=1, model="extremeGauss", seed=i)$Z
#marg.test.ET2[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=2)$Z
#marg.test.ET3[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=3)$Z
marg.test.RS[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1)$Z
marg.test.RS.A[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1, keepPsi=TRUE)$A
}
test <- gev(c(marg.test.RS)); test$par.ests; test$par.ses
test <- gev(c(marg.test.RS.A)); test$par.ests; test$par.ses
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
x <- seq(0,5,by=0.1)
d <- dstable(x, 0.2, 1, 1, 0)
ggplot(data=data.frame(x=c(marg.test.RS.A)), aes(x=x)) +
geom_histogram(aes(y=..density..), col="black", alpha=0.3, bins=100) +
geom_line(data=data.frame(x=x, y=d), aes(y=y), col="red") +
lims(x=c(0,5))
library(stabledist)
beta <- 1
gamma <- 1
delta <- 0
alpha <- 0.4
test <- rstable(1e5, alpha, beta, gamma, delta)
library(ggplot2)
x <- seq(0.01, 100, by=0.01)
y <- dstable(x, alpha, beta, gamma, delta)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..))
summary(test)
?rstable
beta <- 1
gamma <- 1
delta <- 0
alpha <- 0.4
test <- rstable(1e5, alpha, beta, gamma, delta) + tan(pi*alpha/2)
summary(test)
quantile(test, seq(0,1,by=0.1))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..)) +
lims(x=c(0,50))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=50) +
lims(x=c(0,50))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=50) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
test <- rstable(1e6, alpha, beta, gamma, delta) + tan(pi*alpha/2)
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=50) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
alpha <- 0.2
test <- rstable(1e6, alpha, beta, gamma, delta) + tan(pi*alpha/2)
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=50) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta, pm=1)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,50))
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta, pm=0)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
y <- dstable(x, alpha, beta, gamma, delta, pm=2)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
y <- dstable(x, alpha, beta, gamma, delta, pm=1)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
alpha <- 0.5
test <- rstable(1e6, alpha, beta, gamma, delta) + tan(pi*alpha/2)
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta, pm=1)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
alpha <- 0.9
test <- rstable(1e6, alpha, beta, gamma, delta) + tan(pi*alpha/2)
x <- seq(0.01, 50, by=0.1)
y <- dstable(x, alpha, beta, gamma, delta, pm=1)
ggplot() +
geom_histogram(data=data.frame(test), aes(x=test, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=x,y=y), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
summary(test)
test <- rstable(1e6, alpha, beta, gamma, delta)
summary(test)
u <- runif(1e5, -pi/2, pi/2)
w <- rexp(1e5)
zeta <- -1*tan(pi*alpha/2)
zeta <- -1*tan(pi*alpha/2)
xi <- atan(-zeta)/alpha
xi
pi/2
xi <- pi/2
zeta
(1+zeta^2)^(1/(2*alpha))
z <- (1+zeta^2)^(1/(2*alpha))*(sin(alpha*(u+xi))/(cos(u)^(1/alpha)))*(cos(u-alpha*(u+xi)/w))^((1-alpha)/alpha)
summary(z)
u <- runif(1e5, -pi/2, pi/2)
w <- rexp(1e5)
zeta <- -1*tan(pi*alpha/2)
xi <- pi/2
z <- (1+zeta^2)^(1/(2*alpha))*(sin(alpha*(u+xi))/(cos(u)^(1/alpha)))*(cos(u-alpha*(u+xi)/w))^((1-alpha)/alpha)
summary(z)
u <- runif(1e5, -pi/2, pi/2)
w <- rexp(1e5)
zeta <- -1*tan(pi*alpha/2)
xi <- pi/2
z <- (1+zeta^2)^(1/(2*alpha))*(sin(alpha*(u+xi))/(cos(u)^(1/alpha)))*(cos(u-alpha*(u+xi)/w))^((1-alpha)/alpha)
summary(z)
tan(pi*alpha/2)
U <- runif(1e5, 0, pi)
W <- rexp(1e5)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
summary(Z+tan(pi*alpha/2))
alpha <- 0.3
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
alpha <- 0.1
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
alpha <- 0.9
U <- runif(1e6, 0, pi)
W <- rexp(1e6)
Z <- ((sin((1-alpha)*U)*(sin(alpha*U))^(alpha/(1-alpha)))/((sin(U))^(1/(1-alpha))) / W)^((1-alpha)/alpha)
summary(Z)
U <- runif(1e6, -pi/2, pi/2)
W <- rexp(1e6)
Z <- 2*sqrt(W)*sin(U)
summary(Z)
qnorm(0.95, 0, 1)
qnorm(0.75, 0, 1)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100)
sd(Z)
mean(Z)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=seq(-5,5,by=0.01),y=dnorm(seq(-5,5,by=0.01),0, sqrt(2))), aes(x=x,y=y), color="red") +
lims(x=c(0,10), y=c(0,0.5))
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
geom_line(data=data.frame(x=seq(-5,5,by=0.01),y=dnorm(seq(-5,5,by=0.01),0, sqrt(2))), aes(x=x,y=y), color="red")
theta <- rexp(1e6, -pi/2, pi/2)
theta <- runif(1e6, -pi/2, pi/2)
theta0 <- pi/2
W <- rexp(1e6, 1)
b <- alpha*(theta-theta0)
head(theta-theta0)
alpha <- 0.5
b <- alpha*(theta-theta0)
Z <- sin(b)/(cos(theta)^(1/alpha))*(cos(theta-b)/W)^(1/alpha - 1)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100)
summary(Z)
alpha <- 0.5
epsilon <- 1-alpha
theta <- runif(1e6, -pi/2, pi/2)
theta0 <- pi/2
W <- rexp(1e6, 1)
z <- (cos(epsilon*theta-tan(alpha*theta0)*cos(alpha*theta)))/(W*cos(theta))
Z <- tan(alpha*theta0) + ((sin(alpha*theta)-tan(alpha*theta0)*cos(alpha*theta))/cos(theta))*z^(epsilon/(1-epsilon))
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100)
summary(Z)
alpha <- 0.5
zet <- -tan(alpha*pi/2)
con1 <- (1+zet^2)^(1/(2*alpha))
U <- runif(1e5, -pi/2, pi/2)
W <- rexp(1e5, 1)
xi <- pi/2
rm(con1)
alpha <- 0.5
zet <- -tan(alpha*pi/2)
xi <- pi/2
U <- runif(1e5, -pi/2, pi/2)
W <- rexp(1e5, 1)
part1 <- (1+zet^2)^(1/(2*alpha))
part2 <- sin(alpha*(U+xi))
part3 <- cos(U)^(1/alpha)
part4 <- (cos(U-alpha*(U+xi)))/W
Z <- part1 * (part2/part3) * (part4)^((1-alpha)/alpha)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10))
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10)) +
geom_line(data=data.frame(x=seq(0,10,by=0.1),y=dstable(seq(0,10,by=0.1), alpha, 1, 1, 0)), aes(x=x,y=y), color="red")
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10)) +
geom_line(data=data.frame(x=seq(0,10,by=0.1),y=dstable(seq(0,10,by=0.1), alpha, 1, 0, 1)), aes(x=x,y=y), color="red")
?dstable
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10)) +
geom_line(data=data.frame(x=seq(0,10,by=0.1),y=dstable(seq(0,10,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
warnings()
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,10)) +
geom_line(data=data.frame(x=seq(0.1,10,by=0.1),y=dstable(seq(0.1,10,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
alpha <- 0.5
zet <- -tan(alpha*pi/2)
xi <- pi/2
U <- runif(1e5, -pi/2, pi/2)
W <- rexp(1e5, 1)
part1 <- (1+zet^2)^(1/(2*alpha))
part2 <- sin(alpha*(U+xi))
part3 <- cos(U)^(1/alpha)
part4 <- (cos(U-alpha*(U+xi)))/W
Z <- part1 * (part2/part3) * (part4)^((1-alpha)/alpha)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=100) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=200) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=300) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
?ks.test
ks.test(Z, "pstable", alpha, 1, pm=1)
alpha <- 0.3
zet <- -tan(alpha*pi/2)
xi <- pi/2
U <- runif(1e6, -pi/2, pi/2)
W <- rexp(1e6, 1)
part1 <- (1+zet^2)^(1/(2*alpha))
part2 <- sin(alpha*(U+xi))
part3 <- cos(U)^(1/alpha)
part4 <- (cos(U-alpha*(U+xi)))/W
Z <- part1 * (part2/part3) * (part4)^((1-alpha)/alpha)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=300) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
alpha <- 0.7
zet <- -tan(alpha*pi/2)
xi <- pi/2
U <- runif(1e6, -pi/2, pi/2)
W <- rexp(1e6, 1)
part1 <- (1+zet^2)^(1/(2*alpha))
part2 <- sin(alpha*(U+xi))
part3 <- cos(U)^(1/alpha)
part4 <- (cos(U-alpha*(U+xi)))/W
Z <- part1 * (part2/part3) * (part4)^((1-alpha)/alpha)
ggplot() +
geom_histogram(data=data.frame(Z), aes(x=Z, y=..density..), color="black", bins=300) +
lims(x=c(0,20)) +
geom_line(data=data.frame(x=seq(0.1,20,by=0.1),y=dstable(seq(0.1,20,by=0.1), alpha, beta=1, pm=1)), aes(x=x,y=y), color="red")
ks.test(Z, "pstable", alpha, 1, pm=1)
warnings()
n <- 100
n.sim <- 1000
# marg.test.BR  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.EG  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET2 <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET3 <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS.A <- matrix(0, nrow=n.sim, ncol=n)
for(i in 1:n.sim){
#marg.test.BR[i,]  <- simMSP(n=n, dim=1, model="Brown-Resnick", seed=i)$Z
#marg.test.EG[i,]  <- simMSP(n=n, dim=1, model="extremeGauss", seed=i)$Z
#marg.test.ET2[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=2)$Z
#marg.test.ET3[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=3)$Z
marg.test.RS[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1)$Z
marg.test.RS.A[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1, keepPsi=TRUE)$A
}
library(MSP)
n <- 100
n.sim <- 1000
# marg.test.BR  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.EG  <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET2 <- matrix(0, nrow=n.sim, ncol=n)
# marg.test.ET3 <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS.A <- matrix(0, nrow=n.sim, ncol=n)
for(i in 1:n.sim){
#marg.test.BR[i,]  <- simMSP(n=n, dim=1, model="Brown-Resnick", seed=i)$Z
#marg.test.EG[i,]  <- simMSP(n=n, dim=1, model="extremeGauss", seed=i)$Z
#marg.test.ET2[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=2)$Z
#marg.test.ET3[i,] <- simMSP(n=n, dim=1, model="extremeT", seed=i, alpha=3)$Z
marg.test.RS[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1)$Z
marg.test.RS.A[i,] <- simMSP(n=n, model="Reich-Shaby", nknots=100, bw=0.01, alpha=0.2, seed=i+1, keepPsi=TRUE)$A
}
test1 <- simMSP(n=50, dim=2, model="Brown-Resnick", nu=3, seed=6)
test2 <- simMSP(n=50, dim=2, model="extremeGauss", nu=3, seed=6)
test3 <- simMSP(n=50, dim=2, model="extremeT", nu=3, alpha=2, seed=6)
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.5, seed=6)
library(MSP)
library(ggplot2)
test1 <- simMSP(n=50, dim=2, model="Brown-Resnick", nu=3, seed=6)
test2 <- simMSP(n=50, dim=2, model="extremeGauss", nu=3, seed=6)
test3 <- simMSP(n=50, dim=2, model="extremeT", nu=3, alpha=2, seed=6)
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.5, seed=6)
plot.data <- data.frame(cbind(test1$X, test1$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
plot.data <- data.frame(cbind(test2$X, test2$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
plot.data <- data.frame(cbind(test3$X, test3$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.8, seed=6)
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.2, seed=6)
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.1, seed=6)
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.1, seed=4)
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.1, seed=2)
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.1, seed=NULL)
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.95, seed=NULL)
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.10, seed=NULL)
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
test4 <- simMSP(n=50, dim=2, model="Reich-Shaby", alpha=0.10, seed=NULL)
plot.data <- data.frame(cbind(test4$X, test4$Z))
colnames(plot.data) <- c("X", "Y", "Z")
ggplot(data=data.frame(plot.data), aes(x=X, y=Y, z=Z)) +
geom_raster(aes(fill = Z)) +
scale_fill_gradientn(colors=terrain.colors(50)) +
geom_contour(color="white")
library(MSP)
library(ggplot2)
library(evir) # for MLE testing of marginals
library(MSP)
library(stabledist)
n <- 100
alpha <- 0.95
# 1 dimensional simulation
test1 <- simMSP(n=n, dim=1, model="Brown-Resnick")
test2 <- simMSP(n=n, dim=1, model="extremeGauss")
test3 <- simMSP(n=n, dim=1, model="extremeT", alpha=2)
test4 <- simMSP(n=n, dim=1, model="extremeT", alpha=3)
test5 <- simMSP(n=n, dim=1, model="Reich-Shaby", nknots=100, bw=0.5, alpha=alpha, keepPsi=TRUE)
test1 <- simSP(n=n, dim=1, model="Brown-Resnick")
test2 <- simSP(n=n, dim=1, model="extremeGauss")
test3 <- simSP(n=n, dim=1, model="extremeT", alpha=2)
test4 <- simSP(n=n, dim=1, model="extremeT", alpha=3)
test5 <- simReich(n=n, dim=1, nknots=100, bw=0.5, alpha=alpha, keepPsi=TRUE)
library(MSP)
test5 <- simReich(n=n, dim=1, nknots=100, bw=0.5, alpha=alpha, keepPsi=TRUE)
plot.data <- data.frame(
X = c(test1$X, test2$X, test3$X, test4$X, test5$X),
Z = c(test1$Z, test2$Z, test3$Z, test4$Z, test5$Z),
model = factor(c(rep("Brown-Resnick",n), rep("extremeGauss", n), rep("extremeT_2", n),
rep("extremeT_3", n), rep("Reich-Shaby", n))))
ggplot(data=plot.data, aes(x=X, y=Z, color=model)) + geom_line() + theme_bw()
n <- 100
n.sim <- 1000
marg.test.BR  <- matrix(0, nrow=n.sim, ncol=n)
marg.test.EG  <- matrix(0, nrow=n.sim, ncol=n)
marg.test.ET2 <- matrix(0, nrow=n.sim, ncol=n)
marg.test.ET3 <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS.A <- matrix(0, nrow=n.sim, ncol=n)
marg.test.RS.U <- matrix(0, nrow=n.sim, ncol=n)
for(i in 1:n.sim){
marg.test.BR[i,]  <- simSP(n=n, dim=1, model="Brown-Resnick", seed=i)$Z
marg.test.EG[i,]  <- simSP(n=n, dim=1, model="extremeGauss", seed=i)$Z
marg.test.ET2[i,] <- simSP(n=n, dim=1, model="extremeT", seed=i, alpha=2)$Z
marg.test.ET3[i,] <- simSP(n=n, dim=1, model="extremeT", seed=i, alpha=3)$Z
mod <- simReich(n=n, nknots=100, bw=0.01, alpha=alpha, seed=i, keepPsi = TRUE)
marg.test.RS[i,] <- mod$Z
marg.test.RS.A[i,] <- mod$A
marg.test.RS.U[i,] <- mod$U
}
test <- gev(c(marg.test.BR));  test$par.ests; test$par.ses
test <- gev(c(marg.test.EG));  test$par.ests; test$par.ses
test <- gev(c(marg.test.ET2)); test$par.ests; test$par.ses
test <- gev(c(marg.test.ET3)); test$par.ests; test$par.ses
test <- gev(c(marg.test.RS)); test$par.ests; test$par.ses
test <- gev(c(marg.test.RS.U)); test$par.ests; test$par.ses
alpha <- 0.10
test5 <- simReich(n=n, dim=1, nknots=100, bw=0.5, alpha=alpha, keepPsi=TRUE)
plot.data <- data.frame(
X = c(test1$X, test2$X, test3$X, test4$X, test5$X),
Z = c(test1$Z, test2$Z, test3$Z, test4$Z, test5$Z),
model = factor(c(rep("Brown-Resnick",n), rep("extremeGauss", n), rep("extremeT_2", n),
rep("extremeT_3", n), rep("Reich-Shaby", n))))
ggplot(data=plot.data, aes(x=X, y=Z, color=model)) + geom_line() + theme_bw()
test5 <- simReich(n=n, dim=1, nknots=100, bw=0.1, alpha=alpha, keepPsi=TRUE)
plot.data <- data.frame(
X = c(test1$X, test2$X, test3$X, test4$X, test5$X),
Z = c(test1$Z, test2$Z, test3$Z, test4$Z, test5$Z),
model = factor(c(rep("Brown-Resnick",n), rep("extremeGauss", n), rep("extremeT_2", n),
rep("extremeT_3", n), rep("Reich-Shaby", n))))
ggplot(data=plot.data, aes(x=X, y=Z, color=model)) + geom_line() + theme_bw()
test5 <- simReich(n=n, dim=1, nknots=100, bw=0.01, alpha=alpha, keepPsi=TRUE)
plot.data <- data.frame(
X = c(test1$X, test2$X, test3$X, test4$X, test5$X),
Z = c(test1$Z, test2$Z, test3$Z, test4$Z, test5$Z),
model = factor(c(rep("Brown-Resnick",n), rep("extremeGauss", n), rep("extremeT_2", n),
rep("extremeT_3", n), rep("Reich-Shaby", n))))
ggplot(data=plot.data, aes(x=X, y=Z, color=model)) + geom_line() + theme_bw()
